## 브라우저 캐시란?

-  인터넷 브라우저에서 웹 페이지. 이미지. 비디오 및 기타 웹 콘템츠를 재방문할 때 다운로드를 방지하기 위해 로컬 디스크에 저장되는 데이터 저장소
-  이전에 방문한 웹 사이트의 파일을 로컬 저장소에 저장하여, 이후 해당 웹 사이트를 방문할 때 다시 다운로드하지 않고 로컬 저장소에 저장된 파일을 사용하여 더 빠른 로딩 속도를 제공, 이는 브라우저 성능을 향상시키고 인터넷 대역폭을 절약할 수 있음
-  캐시된 데이터가 오래되어서 최신 정보를 제공하지 못하는 경우가 있음

## 활용

1. HTTP 캐시 해더 사용: 웹 서에서 HTTP 응답 헤더에 캐시 제어 지시자를 포함하여 브라우저 캐시를 관라할 수 있다. 이를 통해 캐시파일의 수명, 캐시 가능한 파일의 유형, 캐시를 사용하지 않을 경우의 대처 방법 등을 지정할 수 있다.
2. 자바스크립트와 CSS 파일의 번들링: 웹 페이지에서 자바스크립트와 CSS 파일을 하나의 파일로 번들링하면, 브라우저에서는 캐시된 파일을 사용할 수 있기 때문에 더 빠른 로딩 속도를 제공할 수 있다.

## 브라우저 캐시 오염(browser cache poisoning)

-  동일한 URL을 가진 여러 리소스가 다운로드 되는 경우 브라우저 캐시는 각각의 리소스를 구별하지 못해 같은 이름의 캐시 파일을 생성한다. 이때 HTTP 캐시 헤더가 불완전 하게 설정되어 있거나, 캐시 파일이 오래되어서 최신 정보를 제공하지 못하는 경우가 있다. 이러한 캐시 오염은 웹 애플리케이션의 보안에 치명적인 영향을 미칠 수 있다.
-  해커가 공격 대상자의 웹 브라우저 캐시를 조작하여 악성 코드를 삽입하거나 공격자가 원하는 뤱사이트로 리디렉션하는 공격
-  캐시된 리소스가 변경되었지만 브라우저가 캐시된 버전을 계속 사용하는 경우 악성 코드가 삽입된 리소스를 서버에서 다운로드 받아 브라우저 캐시에 저장
-  브라우저는 캐시된 버전을 계속 사용하기 때문에 악성 코드가 포함된 리소스가 브라우저에 로드
-  공격자는 악성 코드를 실행하거나 사용자를 악성 웹사이트로 리디렉션 할 수 있음

### 방지

1. HTTP 캐시 헤더 설정: HTTP 응답 헤더에 캐시 제어 지시자를 명시하여 캐시 동작을 제어, 이를 통해 캐시 오염을 예방
2. 파일 이름 변경: 파일 이름을 변경하여 캐시 파일 이름 충돌을 방지
3. 파일 버전 관리: 파일 버전 관리를 통해, 동일한 파일의 다양한 버전을 사용하여 캐시 오염을 방지
4. CDN 사용: CDN 서비스를 사용하여 다양한 지역의 캐시 서버를 이용하여 빠른 속도의 콘텐츠 제공과 캐시 오염 방지를 동시에 할 수 있다.
5. 쿼리 스트링 사용: URL 뒤에 쿼리 스트링을 추가하여 동일한 파일을 구분할 수 있다.

## 캐시 제어 지시자(cache control directives)

-  HTTP 응답 헤더에 포함될 수 있는 지시자들로, 클라이언트 측에서 캐시 동작을 제어하는 데 사용된다. 이 지시자들은 캐시 제어, 캐시 유효기간, 캐시 제한, 캐시 강제 제거 등의 작업을 진행할 수 있다.
-  Cache-Control 헤더 필드를 통해 전달. Cache-Control 헤더는 HTTP/1.1에서 도입되었으며, 이전에는 Expires 헤더와 Pragma 헤더가 캐시 제어를 담당

### Cache-Control 헤더 필드

1. public: 응답 내용이 캐시될 수 있음을 나타낸다. public은 응답을 받은 모든 사용자가 캐시할 수 있다는 것을 의미

2. private: 응답 내용이 특정 사용자만 캐시할 수 있음을 나타낸다. private은 브라우저와 같은 개인적인 캐시를 사용하는 클라이언트에 의해 캐시될 수 있다는 것을 의미

3. no-cache: 캐시는 응답을 저장할 수 있지만, 캐시된 리소스를 사용하기 전에 서버에 검증 요청을 보내야 함을 명시한다. 캐시된 리소스가 만료되었을 때만 서버에 검증 요청을 보낸다.

4. no-store: 응답 내용이 캐시되지 않으며 클라이언트에 저장되지 않는다. 이것은 보안적인 이유로 중요한 정보가 포함된 경우 사용

5. must-revalidate: 캐시된 리소스가 만료된 경우, 클라이언트가 서버로 다시 검증 요청을 보내야 함을 나타냄. 만료된 캐시를 사용하면 잘못된 정보를 제공할 수 있기 때문이다. (금융 거래 등의 상황에서는 이러한 동작이 잘못된 결과로 이어질 수 있기 때문에 해당 지시자를 통해 미연에 방지)

6. max-age: 캐시가 유효한 시간을 지정. max-age 값은 초 단위로 표시되며, 이 시간이 지나면 캐시된 리소스는 만료

7. s-maxage: max-age와 유사하지만, 공유 캐시에서만 사용된다. s-maxage 값이 설정된 경우, max-age 값은 무시

## 예상 면접 질문

1. 브라우저 캐시란 무엇이며, 어떤 이점이 있나요?

```txt
브라우저 캐시는 이전에 방문한 웹 사이트에서 다운로드한 리소스(이미지, 스크립트, 스타일 시트 등)를 브라우저에 저장하는 임시 저장소입니다. 이를 통해 사용자가 같은 웹 사이트에 재방문할 때, 브라우저는 캐시된 리소스를 사용하여 페이지 로드 속도를 빠르게 할 수 있습니다. 이는 사용자 경험을 향상시키는 데 도움이 되며, 서버 부하를 줄이고 대역폭을 절약할 수 있습니다.
```

2. 브라우저 캐시는 어떤 방식으로 동작하나요?

```txt
브라우저 캐시는 HTTP 캐시 헤더를 통해 동작합니다. 웹 서버에서 HTTP 응답 헤더에 캐시 제어 지시자를 포함하여 브라우저 캐시를 관리할 수 있습니다. 이를 통해 웹 개발자는 캐시 파일의 수명, 캐시 가능한 파일의 유형, 캐시를 사용하지 않을 경우의 대처 방법 등을 지정할 수 있습니다.
```

3. 브라우저 캐시의 단점은 무엇인가요?

```txt
브라우저 캐시는 장점도 있지만, 단점도 있습니다. 가장 큰 단점은 캐시 오염으로 인한 문제입니다. 캐시 오염은 동일한 URL을 가진 새로운 페이지가 로드되었을 때, 이전 페이지에서 캐시된 리소스를 사용하여 오류가 발생하는 현상을 말합니다. 이를 해결하기 위해서는 웹 개발자가 HTTP 캐시 헤더를 적절히 구성하여 캐시를 관리해야 합니다.
```

4. 브라우저 캐시를 사용하지 않는 방법은 무엇인가요?

```txt
브라우저 캐시를 사용하지 않는 방법으로는 캐시 제어 지시자를 사용하지 않거나, URL에 고유한 매개변수를 추가하여 캐시를 우회하는 방법이 있는데, 이 방법은 웹 개발자가 모든 캐시 가능한 파일에 대해 고유한 매개변수를 추가해야 한다는 단점이 있습니다. 또한, 이 방법은 페이지 로드 시 캐시된 리소스를 사용하지 않기 때문에, 페이지 로드 속도가 느려질 수 있습니다.
```

5. 브라우저 캐시를 지울 때 어떤 문제가 발생할 수 있나요?

```txt
브라우저 캐시를 지울 때는 사용자가 이전에 캐시된 리소스를 사용하지 않고 서버에서 다시 다운로드해야 하기 때문에, 페이지 로드 속도가 느려질 수 있습니다. 또한, 로그인 정보나 사용자 데이터 등이 캐시되어 있을 경우, 캐시를 지우면 해당 정보가 사라질 수 있으므로 주의해야 합니다.
```

6. 브라우저 캐시를 관리하는 방법에는 어떤 것이 있나요?

```txt
웹 개발자는 HTTP 캐시 헤더를 사용하여 브라우저 캐시를 관리할 수 있습니다. 캐시 헤더를 통해 캐시 가능한 파일의 수명을 지정하거나, 캐시를 사용하지 않도록 지시할 수 있습니다. 또한, 웹 개발자는 캐시 이름에 해시를 추가하여 새로운 버전의 파일을 배포할 때마다 캐시를 갱신할 수 있습니다.
```

7. 브라우저 캐시를 사용하지 않도록 지시하는 방법에는 어떤 것이 있나요?

```txt
캐시를 사용하지 않도록 지시하는 방법으로는 HTTP 응답 헤더에 "Cache-Control: no-cache"나 "Cache-Control: no-store"를 추가하는 방법이 있습니다. "Cache-Control: no-cache"는 캐시를 사용하지 않지만, 서버에 재검사를 요청하여 최신 파일을 사용할 수 있도록 합니다. "Cache-Control: no-store"는 캐시를 사용하지 않고, 서버에서 파일을 매번 다운로드해야 합니다.
```
